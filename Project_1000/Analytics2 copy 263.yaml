openapi: 3.1.0
x-stoplight:
  id: aurcqitlflyhl
info:
  title: Analytics
  version: '1.0'
  license:
    url: 'https://opensource.org/licenses/MIT'
    name: MIT
  contact:
    email: dataops@flex.one
    name: Dataops
    url: 'https://www.flex.one'
  description: Endpoints for Analytics
  summary: Analytics
servers:
  - url: 'http://localhost:3000'
    description: Local
  - url: 'https://platform.flexbase.dev'
    description: Development
  - url: 'https://platform.flex.one'
    description: Production
paths:
  /analytics/scrape/flexApi/plaid/transferSweeps:
    get:
      summary: GET scrape plaid transfer sweeps
      x-stoplight:
        id: 4dzux03rp2h5r
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-flex-api-plaid-transfer-sweeps
      description: Endpoint to scrape and store data from /plaid/transferSweeps
    parameters: []
  /analytics/scrape/flexApi/lithic/treasury:
    get:
      summary: GET scrape lithic treasury
      x-stoplight:
        id: ob1w8yryx21r3
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-flexApi-lithic-treasury
      description: Endpoint to scrape and store data from /lithic/treasury
  /analytics/scrape/flexApi/servicing/bookSummary:
    get:
      summary: GET scrape servicing book summary
      x-stoplight:
        id: rk2i65t2ltoc8
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-flexApi-servicing-bookSummary
      description: Endpoint to scrape and store data from /servicing/bookSummary
  /analytics/scrape/hubspot/account/users:
    get:
      summary: GET scrape Hubspot account users
      x-stoplight:
        id: 7pcfz8za40pyf
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-account-users
      description: Endpoint to scrape and store data for Flex's Hubspot account users
  /analytics/scrape/hubspot/goals:
    get:
      summary: GET scrape Hubspot goals
      x-stoplight:
        id: xri9h5c18x6lh
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-goals
      description: Endpoint to scrape and store data for Flex's Hubspot goals
  /analytics/scrape/hubspot/companies:
    get:
      summary: GET scrape Hubspot companies
      x-stoplight:
        id: ce0349ulbb36o
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-companies
      description: Endpoint to scrape and store data for Flex's Hubspot companies
  /analytics/scrape/hubspot/contacts:
    get:
      summary: GET scrape Hubspot contacts
      x-stoplight:
        id: r67qjq94w8z8l
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-contacts
      description: Endpoint to scrape and store data for Flex's Hubspot contacts
  /analytics/scrape/hubspot/deals:
    get:
      summary: GET scrape Hubspot deals
      x-stoplight:
        id: bhgmog3kdolg1
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-deals
      description: Endpoint to scrape and store data for Flex's Hubspot deals
  /analytics/scrape/hubspot/monthlySpend:
    get:
      summary: GET scrape Hubspot monthlySpend
      x-stoplight:
        id: slwz52im2723i
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-monthly-spend
      description: Endpoint to scrape and store data for Flex's Hubspot monthlySpend
  /analytics/scrape/hubspot/events:
    get:
      summary: GET scrape Hubspot events
      x-stoplight:
        id: tbvbtvh28x0b0
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-events
      description: Endpoint to scrape and store data for Flex's Hubspot events
  /analytics/scrape/hubspot/onboarding:
    get:
      summary: GET scrape Hubspot onboarding
      x-stoplight:
        id: l0sfgtmf59v0x
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-onboarding
      description: Endpoint to scrape and store data for Flex's Hubspot onboarding
  /analytics/scrape/hubspot/accountManagement:
    get:
      summary: GET scrape Hubspot accountManagement
      x-stoplight:
        id: rqqzaf1vtuz7p
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-account-management
      description: Endpoint to scrape and store data for Flex's Hubspot accountManagement
  '/analytics/scrape/banking/accounts/{bankAccountId}':
    parameters:
      - $ref: '#/components/parameters/bankAccountId'
    get:
      summary: Scrape a specific Flex Bank Account
      x-stoplight:
        id: ccst29lxiz3ci
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-banking-account
      description: Endpoint to scrape and store data for Flex's Card Funding Account
components:
  schemas:
    ListMetricResult:
      title: ListMetricResult
      x-stoplight:
        id: qs9pitvagbann
      type: object
      description: 'For a given metric, result is a timeseries of that metric with accompanying metadata'
      properties:
        product:
          type: string
          x-stoplight:
            id: a9sos2jy9hefp
        metricKey:
          type: string
          x-stoplight:
            id: z57d1ucgs1ij6
        dateAggregation:
          type: string
          x-stoplight:
            id: 048yfz2b1efuy
        history:
          type: array
          x-stoplight:
            id: ccdozt88fhb45
          items:
            $ref: '#/components/schemas/MetricHistory'
            x-stoplight:
              id: ded5qyj9tq5yk
    MetricHistory:
      title: MetricHistory
      x-stoplight:
        id: dj1tpwrndafse
      type: object
      properties:
        date:
          type: string
          x-stoplight:
            id: 4fjuzqetnsr2d
          format: date
        total:
          type: number
          x-stoplight:
            id: nil8imwq40dw8
        count:
          type: number
          x-stoplight:
            id: eaej9c0reqp1t
        sum:
          type: number
          x-stoplight:
            id: kb0cy062oa885
        avg:
          type: number
          x-stoplight:
            id: woiin108z2bv4
        median:
          type: number
          x-stoplight:
            id: k984klvrc6p12
        min:
          type: number
          x-stoplight:
            id: jteoeb5tg16x2
        max:
          type: number
          x-stoplight:
            id: snncd1jizb8vr
        dimensions:
          type: string
          x-stoplight:
            id: ku5aoyixtc5f4
      description: A single element of the timeseries in a Metric Result
  responses:
    AnalyticsMetric:
      description: Metrics data with pagination metadata
      content:
        application/json:
          schema:
            type: object
            properties:
              data:
                $ref: '#/components/schemas/ListMetricResult'
                x-stoplight:
                  id: q63e5xoo7soaa
              metadata:
                $ref: ./models/PaginationMetadata.yaml
                x-stoplight:
                  id: h0uie6oy0g0zl
  parameters:
    bankAccountId:
      name: bankAccountId
      in: path
      required: true
      schema:
        type: string
      description: The bank account identifier
    startDate:
      name: startDate
      in: query
      required: false
      schema:
        type: string
        format: date
      description: Minimum date to include in response
    endDate:
      name: endDate
      in: query
      required: false
      schema:
        type: string
        format: date
      description: Maximum date to include in response
    dateAggregation:
      name: dateAggregation
      in: query
      required: false
      schema:
        type: string
        enum:
          - year
          - quarter
          - month
          - week
          - day
          - hour
          - minute
          - second
        example: year
      description: 'Unit of aggregation data across dates (daily, weekly, etc...)'
    page:
      name: page
      in: query
      schema:
        type: integer
        minimum: 0
        default: 0
      description: Which page of results to request
    pageSize:
      name: pageSize
      in: query
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 25
        exclusiveMinimum: 0
      description: The number of resources returned per page
    sort:
      name: sort
      in: query
      schema:
        type: string
        enum:
          - asc
          - desc
        default: asc
      description: The sort order of results
    sortDesc:
      name: sort
      in: query
      schema:
        type: string
        enum:
          - asc
          - desc
        default: desc
      description: The sort order of results
    nextToken:
      name: nextToken
      in: query
      schema:
        type: string
      description: A token to retrieve the next set of results
    metricKey:
      name: metricKey
      in: query
      required: true
      schema:
        type: string
      description: Define which pre-defined metric to return; for analytics/metrics endpoints
  securitySchemes:
    token:
      type: http
      scheme: bearer
      description: Bearer token
security:
  - token: []
tags:
  - name: Analytics
    description: Analytics
