openapi: 3.1.0
x-stoplight:
  id: 0mrutlq2rwdqs
info:
  title: Analytics
  version: '1.0'
  license:
    url: 'https://opensource.org/licenses/MIT'
    name: MIT
  contact:
    email: dataops@flex.one
    name: Dataops
    url: 'https://www.flex.one'
  description: Endpoints for Analytics
  summary: Analytics
servers:
  - url: 'http://localhost:3000'
    description: Local
  - url: 'https://platform.flexbase.dev'
    description: Development
  - url: 'https://platform.flex.one'
    description: Production
paths:
  /analytics/scrape/flexApi/plaid/transferSweeps:
    get:
      summary: GET scrape plaid transfer sweeps
      x-stoplight:
        id: 651qxw8mkpbq4
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-flex-api-plaid-transfer-sweeps
      description: Endpoint to scrape and store data from /plaid/transferSweeps
    parameters: []
  /analytics/scrape/flexApi/lithic/treasury:
    get:
      summary: GET scrape lithic treasury
      x-stoplight:
        id: 79zewgaao8zvr
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-flexApi-lithic-treasury
      description: Endpoint to scrape and store data from /lithic/treasury
  /analytics/scrape/flexApi/servicing/bookSummary:
    get:
      summary: GET scrape servicing book summary
      x-stoplight:
        id: skr39z8012fyg
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-flexApi-servicing-bookSummary
      description: Endpoint to scrape and store data from /servicing/bookSummary
  /analytics/scrape/hubspot/account/users:
    get:
      summary: GET scrape Hubspot account users
      x-stoplight:
        id: iadaflv8qpwos
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-account-users
      description: Endpoint to scrape and store data for Flex's Hubspot account users
  /analytics/scrape/hubspot/goals:
    get:
      summary: GET scrape Hubspot goals
      x-stoplight:
        id: c2tcd1tj0djlc
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-goals
      description: Endpoint to scrape and store data for Flex's Hubspot goals
  /analytics/scrape/hubspot/companies:
    get:
      summary: GET scrape Hubspot companies
      x-stoplight:
        id: hs709stkwclri
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-companies
      description: Endpoint to scrape and store data for Flex's Hubspot companies
  /analytics/scrape/hubspot/contacts:
    get:
      summary: GET scrape Hubspot contacts
      x-stoplight:
        id: 7e8kxv276i5tj
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-contacts
      description: Endpoint to scrape and store data for Flex's Hubspot contacts
  /analytics/scrape/hubspot/deals:
    get:
      summary: GET scrape Hubspot deals
      x-stoplight:
        id: lug6p8m67gv9o
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-deals
      description: Endpoint to scrape and store data for Flex's Hubspot deals
  /analytics/scrape/hubspot/monthlySpend:
    get:
      summary: GET scrape Hubspot monthlySpend
      x-stoplight:
        id: nwpo0y2h208q7
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-monthly-spend
      description: Endpoint to scrape and store data for Flex's Hubspot monthlySpend
  /analytics/scrape/hubspot/events:
    get:
      summary: GET scrape Hubspot events
      x-stoplight:
        id: konbqq6ldinu0
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-events
      description: Endpoint to scrape and store data for Flex's Hubspot events
  /analytics/scrape/hubspot/onboarding:
    get:
      summary: GET scrape Hubspot onboarding
      x-stoplight:
        id: 3w0k4q820izk6
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-onboarding
      description: Endpoint to scrape and store data for Flex's Hubspot onboarding
  /analytics/scrape/hubspot/accountManagement:
    get:
      summary: GET scrape Hubspot accountManagement
      x-stoplight:
        id: y99agonk9cezp
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-hubspot-account-management
      description: Endpoint to scrape and store data for Flex's Hubspot accountManagement
  '/analytics/scrape/banking/accounts/{bankAccountId}':
    parameters:
      - $ref: '#/components/parameters/bankAccountId'
    get:
      summary: Scrape a specific Flex Bank Account
      x-stoplight:
        id: 7nac7gr98m9v5
      tags:
        - Analytics
      responses:
        '200':
          description: OK
      operationId: get-scrape-banking-account
      description: Endpoint to scrape and store data for Flex's Card Funding Account
components:
  schemas:
    ListMetricResult:
      title: ListMetricResult
      x-stoplight:
        id: dyyu3ap8gufx4
      type: object
      description: 'For a given metric, result is a timeseries of that metric with accompanying metadata'
      properties:
        product:
          type: string
          x-stoplight:
            id: 3tblgack3v5q0
        metricKey:
          type: string
          x-stoplight:
            id: okzgpkwh3k1c6
        dateAggregation:
          type: string
          x-stoplight:
            id: 3r6okyod36qjb
        history:
          type: array
          x-stoplight:
            id: qvd6485sdz0e0
          items:
            $ref: '#/components/schemas/MetricHistory'
            x-stoplight:
              id: a5uloon2pbmwo
    MetricHistory:
      title: MetricHistory
      x-stoplight:
        id: 8hc18xxq5cc2r
      type: object
      properties:
        date:
          type: string
          x-stoplight:
            id: ppeb6epla8rri
          format: date
        total:
          type: number
          x-stoplight:
            id: 3zgg97v7qzfrc
        count:
          type: number
          x-stoplight:
            id: 4zipppfz2cx58
        sum:
          type: number
          x-stoplight:
            id: 8cu2047vfwe96
        avg:
          type: number
          x-stoplight:
            id: qhws665k67v6j
        median:
          type: number
          x-stoplight:
            id: nj2ozxlwskxyj
        min:
          type: number
          x-stoplight:
            id: msrpjnc9d7481
        max:
          type: number
          x-stoplight:
            id: 6xjdjtdzhi49x
        dimensions:
          type: string
          x-stoplight:
            id: fsp2dau8yszct
      description: A single element of the timeseries in a Metric Result
  responses:
    AnalyticsMetric:
      description: Metrics data with pagination metadata
      content:
        application/json:
          schema:
            type: object
            properties:
              data:
                $ref: '#/components/schemas/ListMetricResult'
                x-stoplight:
                  id: 11qredop3hq72
              metadata:
                $ref: ./models/PaginationMetadata.yaml
                x-stoplight:
                  id: 3ps6nlh6hn4fe
  parameters:
    bankAccountId:
      name: bankAccountId
      in: path
      required: true
      schema:
        type: string
      description: The bank account identifier
    startDate:
      name: startDate
      in: query
      required: false
      schema:
        type: string
        format: date
      description: Minimum date to include in response
    endDate:
      name: endDate
      in: query
      required: false
      schema:
        type: string
        format: date
      description: Maximum date to include in response
    dateAggregation:
      name: dateAggregation
      in: query
      required: false
      schema:
        type: string
        enum:
          - year
          - quarter
          - month
          - week
          - day
          - hour
          - minute
          - second
        example: year
      description: 'Unit of aggregation data across dates (daily, weekly, etc...)'
    page:
      name: page
      in: query
      schema:
        type: integer
        minimum: 0
        default: 0
      description: Which page of results to request
    pageSize:
      name: pageSize
      in: query
      schema:
        type: integer
        minimum: 1
        maximum: 100
        default: 25
        exclusiveMinimum: 0
      description: The number of resources returned per page
    sort:
      name: sort
      in: query
      schema:
        type: string
        enum:
          - asc
          - desc
        default: asc
      description: The sort order of results
    sortDesc:
      name: sort
      in: query
      schema:
        type: string
        enum:
          - asc
          - desc
        default: desc
      description: The sort order of results
    nextToken:
      name: nextToken
      in: query
      schema:
        type: string
      description: A token to retrieve the next set of results
    metricKey:
      name: metricKey
      in: query
      required: true
      schema:
        type: string
      description: Define which pre-defined metric to return; for analytics/metrics endpoints
  securitySchemes:
    token:
      type: http
      scheme: bearer
      description: Bearer token
security:
  - token: []
tags:
  - name: Analytics
    description: Analytics
